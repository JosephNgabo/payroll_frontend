<div class="container-fluid">
  <app-page-title title="Employee Details"></app-page-title>
  <div *ngIf="isLoading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading employee details...</p>
  </div>
  <div class="row" *ngIf="!isLoading && employee">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title mb-4">Employee Details</h4>
          <div id="basic-example">
            <ng-stepper [linear]="true" class="wizard">
              <!-- Step 1: Basic Info -->
              <cdk-step [optional]="false">
                <ng-template cdkStepLabel>
                  <span class="number">1.</span>
                  <span>Personal Info</span>
                </ng-template>
                <section>
                  <form [formGroup]="basicInfoForm" novalidate>
                    <div class="row">
                      <div class="col-lg-4 mb-3">
                        <label>First Name</label>
                        <input type="text" class="form-control" formControlName="firstName" readonly>
                      </div>
                      <div class="col-lg-4 mb-3">
                        <label>Last Name</label>
                        <input type="text" class="form-control" formControlName="lastName" readonly>
                      </div>
                      <div class="col-lg-4 mb-3">
                        <label>Gender</label>
                        <input type="text" class="form-control" formControlName="gender" readonly>
                      </div>
                      <!--
                      <div class="col-lg-4 mb-3">
                        <label>Name of Spouse</label>
                        <input type="text" class="form-control" formControlName="spouseName" readonly>
                      </div>
                      -->
                    </div>
                    <div class="row">
                      <!-- <div class="col-lg-4 mb-3">
                        <label>Gender</label>
                        <input type="text" class="form-control" formControlName="gender" readonly>
                      </div> -->
                      <div class="col-lg-4 mb-3">
                        <label>Date of Birth</label>
                        <input type="text" class="form-control" formControlName="dateOfBirth" readonly>
                      </div>
                      <div class="col-lg-4 mb-3">
                        <label>Nationality</label>
                        <input type="text" class="form-control" [value]="getCountryName(basicInfoForm.value.nationality?.id || basicInfoForm.value.nationality)" readonly>
                      </div>
                      <div class="col-lg-4 mb-3">
                        <label>Country of Birth</label>
                        <input type="text" class="form-control" [value]="getCountryName(basicInfoForm.value.countryOfBirth?.id || basicInfoForm.value.countryOfBirth)" readonly>
                      </div>
                      <!--
                      <div class="col-lg-4 mb-3">
                        <label>Number of Children</label>
                        <input type="text" class="form-control" formControlName="numberOfChildren" readonly>
                      </div>
                      -->
                    </div>
                    <div class="row">
                      <!-- <div class="col-lg-4 mb-3">
                        <label>Nationality</label>
                        <input type="text" class="form-control" [value]="getCountryName(basicInfoForm.value.nationality?.id || basicInfoForm.value.nationality)" readonly>
                      </div>
                      <div class="col-lg-4 mb-3">
                        <label>Country of Birth</label>
                        <input type="text" class="form-control" [value]="getCountryName(basicInfoForm.value.countryOfBirth?.id || basicInfoForm.value.countryOfBirth)" readonly>
                      </div> -->
                      <div class="col-lg-4 mb-3">
                        <label>Marital Status</label>
                        <input type="text" class="form-control" formControlName="maritalStatus" readonly>
                      </div>
                      <div class="col-lg-4 mb-3">
                        <label>Personal Mobile</label>
                        <input type="text" class="form-control" formControlName="personalMobile" readonly>
                      </div>
                      <div class="col-lg-4 mb-3">
                        <label>Personal Email</label>
                        <input type="text" class="form-control" formControlName="personalEmail" readonly>
                      </div>
                    </div>
                    <div class="row">
                      <!-- <div class="col-lg-4 mb-3">
                        <label>Personal Mobile</label>
                        <input type="text" class="form-control" formControlName="personalMobile" readonly>
                      </div>
                      <div class="col-lg-4 mb-3">
                        <label>Personal Email</label>
                        <input type="text" class="form-control" formControlName="personalEmail" readonly>
                      </div> -->
                      <!--
                      <div class="col-lg-4 mb-3">
                        <label>Home Phone</label>
                        <input type="text" class="form-control" formControlName="homePhone" readonly>
                      </div>
                      -->
                    </div>
                  </form>
                </section>
              </cdk-step>
              <!-- Step 2: Legal & Contacts -->
              <cdk-step [optional]="true">
                <ng-template cdkStepLabel>
                  <span class="number">2.</span>
                  <span>Legal & Contacts</span>
                </ng-template>
                <section>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Document Type</label>
                      <input type="text" class="form-control" [value]="employee.document_type" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Document Number</label>
                      <input type="text" class="form-control" [value]="employee.document_number" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Document Issue Date</label>
                      <input type="text" class="form-control" [value]="employee.document_issue_date" readonly>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Document Expiry Date</label>
                      <input type="text" class="form-control" [value]="employee.document_expiry_date" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Place of Issue</label>
                      <input type="text" class="form-control" [value]="employee.document_place_of_issue" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>RSSB Number</label>
                      <input type="text" class="form-control" [value]="employee.rssb_number" readonly>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Highest Education</label>
                      <input type="text" class="form-control" [value]="employee.highest_education" readonly>
                    </div>
                  </div>
                </section>
              </cdk-step>
              <!-- Step 3: Contract -->
              <cdk-step [optional]="true">
                <ng-template cdkStepLabel>
                  <span class="number">3.</span>
                  <span>Contract</span>
                </ng-template>
                <section>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Department</label>
                      <input type="text" class="form-control" [value]="getDepartmentName(employee.employee_contracts?.department)" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Job Title</label>
                      <input type="text" class="form-control" [value]="employee.employee_contracts?.job_title" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Employment Type</label>
                      <input type="text" class="form-control" [value]="employee.employee_contracts?.employment_type" readonly>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Hire Date</label>
                      <input type="text" class="form-control" [value]="employee.employee_contracts?.hire_date" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>End Date</label>
                      <input type="text" class="form-control" [value]="employee.employee_contracts?.end_date" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Salary Basis</label>
                      <input type="text" class="form-control" [value]="getSalaryBasisLabel(employee.employee_contracts?.salary_basis)" readonly>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Salary Amount</label>
                      <input type="text" class="form-control" [value]="employee.employee_contracts?.salary_amount" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Salary Frequency</label>
                      <input type="text" class="form-control" [value]="employee.employee_contracts?.salary_frequency" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>TIN Number</label>
                      <input type="text" class="form-control" [value]="employee.employee_contracts?.tin_number" readonly>
                    </div>
                  </div>
                </section>
              </cdk-step>
              <!-- Step 4: Allowance & Deductions -->
              <cdk-step [optional]="true">
                <ng-template cdkStepLabel>
                  <span class="number">4.</span>
                  <span>Allowance & Deductions</span>
                </ng-template>
                <section>
                  <div class="card mb-4">
                    <div class="card-header bg-success text-white fw-bold">Allowances</div>
                    <div class="card-body">
                      <table class="table table-bordered">
                        <thead>
                          <tr>
                            <th>Name</th>
                            <th>Amount</th>
                            <th>Type</th>
                            <th>Description</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let allowance of employeeAllowances">
                            <td>{{ getAllowanceName(allowance.allowance_id) }}</td>
                            <td>{{ allowance.amount }}</td>
                            <td>{{ allowance.type }}</td>
                            <td>{{ allowance.description }}</td>
                          </tr>
                          <tr *ngIf="employeeAllowances.length === 0">
                            <td colspan="4" class="text-center">No allowances added.</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                  <div class="card mb-4">
                    <div class="card-header bg-warning text-dark fw-bold">Deductions</div>
                    <div class="card-body">
                      <h5>RSSB Deductions</h5>
                      <table class="table table-bordered">
                        <thead>
                          <tr>
                            <th>Deduction Name</th>
                            <th>Employee Contribution</th>
                            <th>Employer Contribution</th>
                            <th>Description</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let deduction of employeeRssbDeductions">
                            <td>{{ deduction.rssb_name }}</td>
                            <td>{{ deduction.rssb_employee_contribution }}</td>
                            <td>{{ deduction.rssb_employer_contribution }}</td>
                            <td>{{ deduction.rssb_description }}</td>
                          </tr>
                          <tr *ngIf="employeeRssbDeductions.length === 0">
                            <td colspan="3" class="text-center">No RSSB deductions added.</td>
                          </tr>
                        </tbody>
                      </table>
                      <h5>Other Deductions</h5>
                      <table class="table table-bordered">
                        <thead>
                          <tr>
                            <th>Deduction Name</th>
                            <th>Amount</th>
                            <th>Type</th>
                            <th>Description</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let deduction of employeeOtherDeductions">
                            <td>{{ getDeductionName(deduction.deduction_id) }}</td>
                            <td>{{ deduction.amount }}</td>
                            <td>{{ deduction.type }}</td>
                            <td>{{ deduction.description }}</td>
                          </tr>
                          <tr *ngIf="employeeOtherDeductions.length === 0">
                            <td colspan="4" class="text-center">No other deductions added.</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </section>
              </cdk-step>
              <!-- Step 5: Bank Info -->
              <cdk-step [optional]="true">
                <ng-template cdkStepLabel>
                  <span class="number">5.</span>
                  <span>Bank Info</span>
                </ng-template>
                <section>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Bank Name</label>
                      <input type="text" class="form-control" [value]="employeeBankInfo?.bank_name" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Account Number</label>
                      <input type="text" class="form-control" [value]="employeeBankInfo?.account_number" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Account Name</label>
                      <input type="text" class="form-control" [value]="employeeBankInfo?.account_name" readonly>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>IBAN</label>
                      <input type="text" class="form-control" [value]="employeeBankInfo?.iban" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>SWIFT Code</label>
                      <input type="text" class="form-control" [value]="employeeBankInfo?.swift_code" readonly>
                    </div>
                  </div>
                </section>
              </cdk-step>
              <!-- Step 6: Address -->
              <cdk-step [optional]="true">
                <ng-template cdkStepLabel>
                  <span class="number">6.</span>
                  <span>Address</span>
                </ng-template>
                <section>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Country</label>
                      <input type="text" class="form-control" [value]="getCountryName(employeeAddress?.country)" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Province</label>
                      <input type="text" class="form-control" [value]="getProvinceName(employeeAddress?.province?.id || employeeAddress?.province)" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>District</label>
                      <input type="text" class="form-control" [value]="getDistrictName(employeeAddress?.district?.id || employeeAddress?.district)" readonly>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Sector</label>
                      <input type="text" class="form-control" [value]="getSectorName(employeeAddress?.sector?.id || employeeAddress?.sector)" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Cell</label>
                      <input type="text" class="form-control" [value]="getCellName(employeeAddress?.cell?.id || employeeAddress?.cell)" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Village</label>
                      <input type="text" class="form-control" [value]="getVillageName(employeeAddress?.village?.id || employeeAddress?.village)" readonly>
                    </div>
                  </div>
                </section>
              </cdk-step>
              <!-- Step 7: Emergency -->
              <cdk-step [optional]="true">
                <ng-template cdkStepLabel>
                  <span class="number">7.</span>
                  <span>Emergency</span>
                </ng-template>
                <section>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Name</label>
                      <input type="text" class="form-control" [value]="employeeEmergencyContact?.name || ''" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Gender</label>
                      <input type="text" class="form-control" [value]="employeeEmergencyContact?.gender || ''" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Relationship</label>
                      <input type="text" class="form-control" [value]="employeeEmergencyContact?.relationship || ''" readonly>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Phone</label>
                      <input type="text" class="form-control" [value]="employeeEmergencyContact?.phone || ''" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Email</label>
                      <input type="text" class="form-control" [value]="employeeEmergencyContact?.email || ''" readonly>
                    </div>
                  </div>
                </section>
              </cdk-step>
              <!-- Step 8: Documents -->
              <cdk-step [optional]="true">
                <ng-template cdkStepLabel>
                  <span class="number">8.</span>
                  <span>Documents</span>
                </ng-template>
                <section>
                  <div class="row">
                    <div class="col-lg-4 mb-3">
                      <label>Document Type</label>
                      <input type="text" class="form-control" [value]="getDocumentTypeName(employeeDocument?.document_type_id)" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Description</label>
                      <input type="text" class="form-control" [value]="employeeDocument?.description || ''" readonly>
                    </div>
                    <div class="col-lg-4 mb-3">
                      <label>Expiration Date</label>
                      <input type="text" class="form-control" [value]="employeeDocument?.expiration_date || ''" readonly>
                    </div>
                  </div>
                </section>
              </cdk-step>
            </ng-stepper>
          </div>
        </div>
        <div class="card-footer text-end">
          <a class="btn btn-secondary" [routerLink]="['/employees/employees-view']">
            <i class="mdi mdi-arrow-left me-1"></i> BACK
          </a>
        </div>
      </div>
    </div>
  </div>
</div> 